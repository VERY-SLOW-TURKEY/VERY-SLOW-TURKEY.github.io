<!DOCTYPE html>
<html>
<head>
<title>Chatter</title>
<style>
body {
font-family: sans-serif;
background-color: #000010;
}

#roomSelector {
position: absolute;
top: 50%;
right: 40%;
font-size: 250%;
}

#roomSelectorButton {
position: absolute;
top: 50%;
right: 31%;
font-size: 250%;
}

#roomSelectorButton:hover {
position: absolute;
top: 50%;
right: 31%;
font-size: 250%;
background-color: #dddddd;
}

#chatText {
position: fixed;
top: 90%;
right: 70%;
font-size: 200%;
}

#chatTextButton {
position: fixed;
top: 90%;
right: 63.5%;
font-size: 200%;
}

#chatTextButton:hover {
position: absolute;
top: 90%;
right: 63.5%;
font-size: 200%;
background-color: #dddddd;
}

#chats {
font-size: 150%;
color: white;
}
  
</style>
</head>
<body>

<input type="text" id="roomSelector" placeHolder="Enter Or Create A Room">
<button onclick="enterRoom()" id="roomSelectorButton">Enter</button>

<input hidden type="text" id="chatText" placeHolder="Send A Message">
<button hidden onclick="sendChat()" id="chatTextButton">Enter</button>

<p id="chats"></p>
  
<script src="three.js"></script>
<script src="PointerLockControls.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<script>
const firebaseConfig = {
apiKey: "AIzaSyB6Ocget3hz66FmLY-Vi9N-LvenvEJILt0",
authDomain: "chatter-e5b3a.firebaseapp.com",
databaseURL: "https://chatter-e5b3a-default-rtdb.firebaseio.com",
projectId: "chatter-e5b3a",
storageBucket: "chatter-e5b3a.appspot.com",
messagingSenderId: "77042429819",
appId: "1:77042429819:web:bcac6edb8539a9442797de"
};

// Initialize Firebase
const app = firebase.initializeApp(firebaseConfig);

// variables
var room = 'chicken';
var roomRef = firebase.database().ref(room);
var chatString = '';

function enterRoom() {
room = document.getElementById('roomSelector').value;
roomRef = firebase.database().ref(room);
chatString = '';
document.getElementById('roomSelector').hidden = true;
document.getElementById('roomSelectorButton').hidden = true;
document.getElementById('chatText').hidden = false;
document.getElementById('chatTextButton').hidden = false;
showChats();
}

function sendChat() {
chatCode = Math.random() * 10000000000000000000;
var chat = firebase.database().ref(room + '/' + chatCode.toString());
chat.set(document.getElementById('chatText').value);
}
  
//roomRef.on('value', (snapshot) => {
//console.log('hi');
//});

function showChats() {
roomRef.on('child_added', (snapshot) => {
console.log('New chat.');
var chat = snapshot.val() || {};
chatString = chatString + '<br>' + chat;
document.getElementById('chats').innerHTML = chatString;
});
}

console.log('test 19');
</script>

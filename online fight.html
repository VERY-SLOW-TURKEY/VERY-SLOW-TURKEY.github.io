<!DOCTYPE html>
<html>
<head>
<title>Online Fight</title>
<style>
body { margin:0; }
</style>
</head>
<body>
<script src="three.js"></script>
<script src="PointerLockControls.js"></script>
<script src="GLTFLoader.js"></script>
<script>

// variables
var aDown = false;
var dDown = false;
var wDown = false;
var sDown = false;

window.addEventListener('keyup', keyUp);
window.addEventListener('keydown', keyDown);
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 );
const renderer = new THREE.WebGLRenderer();
renderer.setSize( window.innerWidth, window.innerHeight );
document.body.appendChild( renderer.domElement );
var controls = new THREE.PointerLockControls(camera, document.body);
renderer.shadowMap.enabled = true;

// level
const light = new THREE.PointLight(0xffffff, 3);
light.position.set(0, 10, 0);
scene.add(light);
light.castShadow = true;
const ambLight = new THREE.AmbientLight(0xffffff, 0.5);
scene.add(ambLight);
const sandFloorGeo = new THREE.PlaneGeometry(100, 100);
const sandMat = new THREE.MeshLambertMaterial({
color: 0xd2aa6d,
emissive: 0x000000
});
const sandFloor = new THREE.Mesh(sandFloorGeo, sandMat);
scene.add(sandFloor);
sandFloor.rotation.x = Math.PI * 1.5;
sandFloor.position.y = -1;
sandFloor.receiveShadow = true;
sandFloor.castShadow = true;
const cubeGeo = new THREE.BoxGeometry(1, 1, 1);
const blueMat = new THREE.MeshLambertMaterial({
color: 0x0000ff,
emissive: 0x000000
});
const cube = new THREE.Mesh(cubeGeo, blueMat);
scene.add(cube);
cube.castShadow = true;
cube.receiveShadow = true;
cube.position.x = 5;
cube.rotation.y = Math.PI / 4;

document.onclick = function(event) {
controls.lock();
}

function gameLoop() {
renderer.render(scene, camera);
move();
requestAnimationFrame(gameLoop);
}
gameLoop();

function keyDown(event) {
const k = event.key;
if (k == 'a') {aDown = true;}
if (k == 'd') {dDown = true;}
if (k == 'w') {wDown = true;}
if (k == 's') {sDown = true;}
if (k == ' ') {camera.position.y += 0.1;}
}

function keyUp(event) {
const k = event.key;
if (k == 'a') {aDown = false;}
if (k == 'd') {dDown = false;}
if (k == 'w') {wDown = false;}
if (k == 's') {sDown = false;}
}

function move() {
if (wDown) {controls.moveForward(.1);}
if (sDown) {controls.moveForward(-.1);}
if (aDown) {controls.moveRight(-.1);}
if (dDown) {controls.moveRight(.1);}
}

const gltfLoader = new THREE.GLTFLoader();
gltfLoader.load('./swat/scene.gltf', (gltfScene) => {
  scene.add(gltfScene.scene);
  gltfScene.scene.scale.set(0.01, 0.01, 0.01);
  gltfScene.scene.position.y = -1;
});
  
gltfLoader.load('./swat/scene.gltf', (gltfScene2) => {
  scene.add(gltfScene2.scene);
  gltfScene2.scene.scale.set(0.01, 0.01, 0.01);
  gltfScene2.scene.position.set(5, -1, 5);
});
  
console.log('test 4');

// credits
// "Swat" (https://skfb.ly/6FTNV) by doctortex is licensed under Creative Commons Attribution (http://creativecommons.org/licenses/by/4.0/).

</script>
</body>
</html>
